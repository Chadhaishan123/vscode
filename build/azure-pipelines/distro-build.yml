pool:
  vmImage: "ubuntu-latest"

trigger:
  branches:
    include: ["main", "release/*"]
pr: none

steps:
  - task: NodeTool@0
    inputs:
      versionSpec: "16.x"
  - template: ./distro/download-distro.yml
  - script: node build/azure-pipelines/distro/apply-patches
    displayName: Apply distro patches
  - script: yarn --frozen-lockfile --check-files
    workingDirectory: .build/distro/npm
    displayName: Install distro node modules
  - script: node build/azure-pipelines/distro/mixin-npm
    displayName: Mixin distro node modules
  - script: node build/azure-pipelines/distro/mixin-quality
    env:
      VSCODE_QUALITY: stable
    displayName: Mixin distro quality
